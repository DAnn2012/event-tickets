"undefined"==typeof tribe&&(tribe={}),void 0===tribe.tickets&&(tribe.tickets={}),tribe.tickets.registration={},function(n,o){"use strict";o.hasChanges=!1,o.selector={container:".tribe-block__tickets__registration__event",fields:".tribe-block__tickets__item__attendee__fields",fieldsError:".tribe-block__tickets__item__attendee__fields__error",form:".tribe-block__tickets__item__attendee__fields__form",toggler:".tribe-block__tickets__registration__toggle__handler",status:".tribe-block__tickets__registration__status",field:{text:".tribe-block__tickets__item__attendee__field__text",checkbox:".tribe-block__tickets__item__attendee__field__checkbox",select:".tribe-block__tickets__item__attendee__field__select",radio:".tribe-block__tickets__item__attendee__field__radio"},checkout:".tribe-block__tickets__registration__checkout"},0!==n(o.selector.container).length&&(n(o.selector.container).on("click",o.selector.toggler,function(e){e.preventDefault();var t=n(this);t.closest(o.selector.container).find(o.selector.fields).toggle(),t.toggleClass("open")}),o.validateEventAttendees=function(e){var t=!0;return e.find(".tribe-tickets-meta-required").each(function(){var e=n(this);0===(e.is(o.selector.field.radio)||e.is(o.selector.field.checkbox)?e.find("input:checked").length?"checked":"":e.is(o.selector.field.select)?e.find("select").val():e.find("input, textarea").val().trim()).length&&(t=!1)}),t},o.handleSaveSubmission=function(e){e.preventDefault();var t=n(this),i=t.parent(o.selector.fields);if(o.validateEventAttendees(t)){var s=t.serializeArray();n.post(window.location.href,s,function(e){})}else i.find(o.selector.fieldsError).show(),n("html, body").animate({scrollTop:i.offset().top},300)},o.handleCheckoutSubmission=function(e){!o.hasChanges||confirm(tribe_l10n_datatables.registration_prompt)||e.preventDefault()},o.setHasChanges=function(){o.hasChanges=!0},o.bindFormFields=function(){[n(o.selector.field.text),n(o.selector.field.checkbox),n(o.selector.field.radio),n(o.selector.field.select)].forEach(function(e){(e.is(o.selector.field.radio)||e.is(o.selector.field.checkbox)?e.find("input"):e.is(o.selector.field.select)?e.find("select"):e.find("input, textarea")).change(o.setHasChanges)})},o.bindCheckout=function(){var e=n(o.selector.checkout);e.length&&e.submit(o.handleCheckoutSubmission)},o.bindEvents=function(){o.bindFormFields(),o.bindCheckout()},o.initPage=function(){n(o.selector.container).each(function(){var e=n(this);o.validateEventAttendees(e)?(e.find(o.selector.status).removeClass("incomplete"),e.find(o.selector.status).find("i").removeClass("dashicons-edit"),e.find(o.selector.status).find("i").addClass("dashicons-yes")):e.find(o.selector.status).addClass("incomplete");var t=e.find(o.selector.form);n(t).on("submit",o.handleSaveSubmission)}),o.bindEvents()},o.init=function(){o.initPage()},o.init())}(jQuery,tribe.tickets.registration);