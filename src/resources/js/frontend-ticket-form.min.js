var tribe_tickets_ticket_form={};!function(t,e){var _,i;e.init=function(){_=t(".tribe-events-tickets"),i=_.find(".quantity").find(".qty"),i.on("change",e.on_quantity_change)},e.on_quantity_change=function(){var _=t(this),i=e.get_matching_ticket_id(this);e.ticket_uses_global_stock(i)?e.global_stock_quantity_changed(_,i):e.normal_stock_quantity_changed(_,i)},e.global_stock_quantity_changed=function(t,_){var i=t.val(),c=e.get_event_id(_),n=e.get_cap(_),a=e.get_global_stock(c),o=e.currently_requested_global_event_stock(c);o>a&&(i-=o-a),e.stock_mode_is_capped(_)&&i>n&&(i=n),0>=i&&(i=0),t.val(i),e.update_available_stock_counts(c)},e.normal_stock_quantity_changed=function(t,i){var c,n=t.val(),a=e.get_single_stock(i);n>a&&(n=a),t.val(n),c=a-n,_.find(".available-stock[data-product-id="+i+"]").html(c)},e.update_available_stock_counts=function(i){var c=e.get_tickets_of(i),n=e.get_global_stock(i)-e.currently_requested_global_event_stock(i);for(var a in c)if(c.hasOwnProperty(a)){n<0&&(n=0);var o=c[a];if("global"===o.mode&&_.find(".available-stock[data-product-id="+a+"]").html(n),"capped"===o.mode){var r=Math.min(n,o.cap),s=parseInt(t("[data-product-id="+a+"]").find("input").val(),10),d=o.cap-s;d<0?d=0:d>r&&(d=r),_.find(".available-stock[data-product-id="+a+"]").html(d)}}},e.get_matching_ticket_id=function(e){var _=t(e).closest("[data-product-id]");if(_.length)return _.data("product-id")},e.get_ticket_property=function(t,e){if("object"!=typeof tribe_tickets_stock_data)return!1;var _=tribe_tickets_stock_data.tickets[t];return"undefined"!==tribe_tickets_stock_data.tickets[t]&&_[e]},e.get_tickets_of=function(t){if("object"!=typeof tribe_tickets_stock_data)return!1;var e=[];for(var _ in tribe_tickets_stock_data.tickets){var i=tribe_tickets_stock_data.tickets[_];t===i.event_id&&(e[_]=i)}return e},e.currently_requested_global_event_stock=function(t){var i=0,c=e.get_tickets_of(t);for(var n in c)switch(tribe_tickets_stock_data.tickets[n].mode){case"global":case"capped":i+=parseInt(_.find("[data-product-id="+n+"]").find(".qty").val(),10)}return i},e.get_event_property=function(t,e){if("object"!=typeof tribe_tickets_stock_data)return!1;var _=tribe_tickets_stock_data.events[t];return"undefined"!==tribe_tickets_stock_data.events[t]&&_[e]},e.stock_mode_is_global=function(t){return"global"===e.get_mode(t)},e.stock_mode_is_capped=function(t){return"capped"===e.get_mode(t)},e.ticket_uses_global_stock=function(t){return e.stock_mode_is_capped(t)||e.stock_mode_is_global(t)},e.get_mode=function(t){return e.get_ticket_property(t,"mode")},e.get_event_id=function(t){return e.get_ticket_property(t,"event_id")},e.get_cap=function(t){return e.get_ticket_property(t,"cap")},e.get_global_stock=function(t){return e.get_event_property(t,"stock")},e.get_single_stock=function(t){return e.get_ticket_property(t,"stock")},t(function(){e.init()}),t(window).on("click",".button-events-list",function(t){t.preventDefault();var e=t.target.parentElement.action;window.location=e})}(jQuery,tribe_tickets_ticket_form);