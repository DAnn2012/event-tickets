jQuery(document).ready(function(t){function e(e){var n=0,i=e.find("td, th");return i.length?(i.each(function(){var e=parseInt(t(this).attr("colspan"),10);e=e>1?e-1:0,n+=1+e}),n):0}if("undefined"!=typeof AttendeesPointer&&null!==AttendeesPointer){options=t.extend(AttendeesPointer.options,{close:function(){t.post(ajaxurl,{pointer:AttendeesPointer.pointer_id,action:"dismiss-wp-pointer"})},open:function(t,e){e.pointer.css({top:parseInt(e.pointer.css("top").replace("px",""),10)+5}).find(".wp-pointer-arrow").css({right:"50px",left:"auto"}),e.element.on({click:function(){e.element.pointer("close")}})}});t(AttendeesPointer.target).pointer(options).pointer("open").pointer("widget")}t("input.print").on("click",function(t){window.print()});var n=t(document.getElementById("filter_attendee"));n.on("keydown",function(t){return 13===t.keyCode?!1:void 0}),n.on("keyup paste",function(){var e=jQuery(this).val().toLowerCase();t("#the-list").find("tr").each(function(n,i){var r=t(i),a=r.children("td.order_id").children("a").text(),o=r.children("td.attendee_id").text(),c=r.children("td.security").text(),d=0===o.indexOf(e)||0===a.indexOf(e)||0===c.indexOf(e),s=r.children("td.purchaser_name").text().toLowerCase(),h=0===s.indexOf(e)||s.indexOf(" "+e)>1;d||h?r.show():r.hide()})}),t(".tribe-attendees-email").on({submit:function(e){t(".tribe-attendees-email").hide(),t(document.getElementById("tribe-loading")).show()}}),t(".tickets_checkin").click(function(e){var n=jQuery(this),i={action:"tribe-ticket-checkin-"+n.attr("data-provider"),provider:n.attr("data-provider"),order_ID:n.attr("data-attendee-id"),nonce:Attendees.checkin_nonce};n.attr("data-event-id")&&(i.event_ID=n.attr("data-event-id")),t.post(ajaxurl,i,function(e){e.success&&(n.parent("td").parent("tr").addClass("tickets_checked"),t("#total_checkedin").text(parseInt(t("#total_checkedin").text())+1))},"json"),e.preventDefault()}),t(".tickets_uncheckin").click(function(e){var n=jQuery(this),i={action:"tribe-ticket-uncheckin-"+n.attr("data-provider"),provider:n.attr("data-provider"),order_ID:n.attr("data-attendee-id"),nonce:Attendees.uncheckin_nonce};n.attr("data-event-id")&&(i.event_ID=n.attr("data-event-id")),t.post(ajaxurl,i,function(e){e.success&&(n.parent("span").parent("td").parent("tr").removeClass("tickets_checked"),t("#total_checkedin").text(parseInt(t("#total_checkedin").text())-1))},"json"),e.preventDefault()}),t("#doaction, #doaction2").click(function(e){var n;switch(t(e.currentTarget).attr("id")){case"doaction":n="action";break;case"doaction2":n="action2"}if("undefined"!=typeof n&&"move"===t('select[name="'+n+'"]').val()){var i=jQuery('input[name="attendee[]"]:checked');if(i.length){var r=Attendees.move_url,a=[];i.each(function(){var e=t(this).val().match(/^[0-9]+/);e&&a.push(e.toString())});var o=parseInt(.7*t(window).width());o=o>800?800:o;var c=parseInt(.9*t(window).height());c=c>800?800:c;var d="&ticket_ids="+a.join("|")+"&width="+o+"&height="+c;r=r.replace("&TB_",d+"&TB_"),tb_show(null,r,!1)}else alert(Attendees.cannot_move);return e.stopPropagation(),!1}}),function(){var n=t(".ticket-history"),i=t(".hide-ticket-history");i.hide(),n.click(function(n){function i(){var n={action:"get_ticket_history",check:c,ticket_id:o};t.post(ajaxurl,n,function(n){if("undefined"!=typeof n.data&&"string"==typeof n.data.html){var i=r.parents("tr"),c=e(i),d=t('<tr id="ticket-history-'+o+'"> <td colspan="'+c+'">'+n.data.html+"</td></tr>");d.hide().insertAfter(i).slideDown(),r.hide(),a.show()}})}var r=t(this),a=r.siblings(".hide-ticket-history"),o=parseInt(r.data("ticket-id"),10),c=r.data("check");if(o&&c){var d=t(document.getElementById("ticket-history-"+o));return d.length?(d.show(),r.hide(),a.show()):i(),n.stopPropagation(),!1}}),i.click(function(e){var n=t(this),i=n.siblings(".ticket-history"),r=parseInt(i.data("ticket-id"),10);t(document.getElementById("ticket-history-"+r)).hide(),i.show(),n.hide()})}()});